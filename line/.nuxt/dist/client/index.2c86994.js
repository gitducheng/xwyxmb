(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{354:function(e,t,n){"use strict";var r=n(6),o=n(355)(6),l="findIndex",c=!0;l in[]&&Array(1)[l]((function(){c=!1})),r(r.P+r.F*c,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(134)(l)},355:function(e,t,n){var r=n(34),o=n(131),l=n(37),c=n(18),h=n(356);e.exports=function(e,t){var n=1==e,d=2==e,f=3==e,v=4==e,y=6==e,m=5==e||y,w=t||h;return function(t,h,T){for(var x,I,C=l(t),R=o(C),A=r(h,T,3),L=c(R.length),S=0,O=n?w(t,L):d?w(t,0):void 0;L>S;S++)if((m||S in R)&&(I=A(x=R[S],S,C),e))if(n)O[S]=I;else if(I)switch(e){case 3:return!0;case 5:return x;case 6:return S;case 2:O.push(x)}else if(v)return!1;return y?-1:f||v?v:O}}},356:function(e,t,n){var r=n(357);e.exports=function(e,t){return new(r(e))(t)}},357:function(e,t,n){var r=n(12),o=n(189),l=n(3)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[l])&&(t=void 0)),void 0===t?Array:t}},359:function(e,t,n){"use strict";n.r(t);n(354),n(130),n(33);var r=n(2),o=n(311),l=n.n(o),c=n(321),h=n(322),d=n(323),f=n(324),v=(n(31),n(32),n(10),n(312),n(22)),y=n(313),m=n(317),w=n(315),T=n(316),x=n(314),I=n(318);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(x.a)(e);if(t){var o=Object(x.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(T.a)(this,n)}}var R=function(e){Object(w.a)(n,e);var t=C(n);function n(e){var r;Object(y.a)(this,n),(r=t.call(this,e)).selected=[],r.isText=!1,r.rightX=800,r.distance=null,r.setAnswerQuestionsId=[],r.setAnswer=[],r.resultIds=[],r.rotationDeg=0,r.lineX=null,r.lineBase=null,r.errorIcon=null,r.repeatAnswerIndex=[],r.readyLine={isStart:!1},r.stage=null,r.temporaryQuestionsContainer=null,r.temporaryLinesContainer=null,r.temporarySelected=null,r.temporaryLinesMove=null,r.questionsLength=0,r.stage=e.stage,r.creatContainer(),r.isText="text"===e.questions.type,r.questionsLength=e.questions.left.length;var o=r.isText?5:4,l=r.isText?130:170;return r.distance=l*(o/r.questionsLength),r.initQuestion(e),r.setAnswerQuestionsId=e.answerQuestionsIds,r.setAnswer=e.answerRealIds,r.resultIds=e.resultIds,r.errorIcon=e.images.errorIcon,"panel"===e.type?Object(T.a)(r):(r.resutlLine(e),r)}return Object(m.a)(n,[{key:"creatContainer",value:function(){this.temporaryLinesContainer=new l.a.Container({x:311,y:this.isText?320-10*this.questionsLength:280-10*this.questionsLength}).addTo(this),this.temporaryQuestionsContainer=new l.a.Container({x:311,y:this.isText?320-10*this.questionsLength:280-10*this.questionsLength}).addTo(this),this.temporarySelected=new l.a.Container({x:311,y:this.isText?320-10*this.questionsLength:280-10*this.questionsLength}).addTo(this),this.temporaryLinesMove=new l.a.Container({x:0,y:0}).addTo(this)}},{key:"commonLine",value:function(e,t,image,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"panel",o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.rotationDeg=180*Math.atan2(t-e,this.lineBase)/Math.PI;var c,h=new l.a.Container({id:this.selected[0]&&this.selected[0].realId,rotation:this.rotationDeg,x:this.lineX-5,y:this.isText?e:e+10}).addTo(this.temporaryLinesContainer),d=Math.floor(Math.sqrt(Math.pow(Math.abs(e-t),2)+Math.pow(this.lineBase,2))),f=new l.a.Bitmap({x:0,y:0,image:image,rect:[0,0,d,17],visible:!0,scaleX:n?0:1,scaleY:n?0:1}).addTo(h);"result"===r&&new l.a.Bitmap((c={x:d/2-34,y:-20,image:this.errorIcon,rect:[0,0,68,68],visible:!0,scaleX:1,scaleY:1},Object(v.a)(c,"visible",!0),Object(v.a)(c,"alpha",o?1:0),c)).addTo(h);return n&&l.a.Tween.to(f,{scaleX:1,scaleY:1},{duration:200}),h}},{key:"line",value:function(e){var t=this;if(this.verifyRepeat()){this.temporaryLinesMove.removeAllChildren(),this.repeatAnswerIndex.length&&this.repeatAnswerIndex.forEach((function(e,n){t.temporaryLinesContainer.removeChildById(t.setAnswer[e-n][0]),t.setAnswer.splice(e-n,1),t.setAnswerQuestionsId.splice(e-n,1)})),this.repeatAnswerIndex=[];var n=this.selected[0].realId*this.distance+50,r=this.selected[1].realId*this.distance+50;this.commonLine(n,r,e.images.rightLine,!0),this.setAnswer.push([this.selected[0].realId,this.selected[1].realId]),this.setAnswerQuestionsId.push([this.selected[0].questionId,this.selected[1].questionId]),this.selected=[],this.readyLine.isStart=!1}}},{key:"resutlLine",value:function(e){var t=this;this.resultIds.forEach((function(n,r){var o,l,c,h=e.answerQuestionsIds[r][0]!==e.answerQuestionsIds[r][1];"result"===e.type?(o=h?e.images.errorLine:e.images.rightLine,l=e.answerRealIds[r][0]*t.distance+50,c=e.answerRealIds[r][1]*t.distance+50):(o=(h=!e.answerRealIds.filter((function(e){return e.join("")===n.join("")})).length)?e.images.tipsLine:e.images.rightLine,l=n[0]*t.distance+50,c=n[1]*t.distance+50),t.commonLine(l,c,o,!1,e.type,h)}))}},{key:"initQuestion",value:function(e){var t=this,rect=this.isText?[0,0,499,106]:[0,0,245,179],n=this.isText?0:265,r=this.isText?1:.8;this.lineX=n+rect[2]*r,this.lineBase=this.isText?320:360;var o=[],c=[],h=[],d=[];e.questions.left.forEach((function(h,d){o[d]=new l.a.Bitmap({x:n,y:d*t.distance,image:e.images.questionLeft,rect:rect,visible:!0,scaleX:r,scaleY:r}).addTo(t.temporaryQuestionsContainer),c[d]=new I.a({id:{realId:d,questionId:h.id},text:h.text,fontSize:t.isText?70:35,bold:!0,textAlign:"center",visible:!0,alpha:1,reTextWidth:rect[2]*r,height:rect[3]*r-(t.isText?15:50),x:n,y:d*t.distance+(t.isText?20:55),color:"#9d6c3c"}).addTo(t.temporaryQuestionsContainer),t.panelClick("left",c[d],o[d],e,n,d*t.distance,r,t.isText?1.05:.9,rect)})),e.questions.right.forEach((function(n,o){if(d[o]=new l.a.Bitmap({x:t.rightX,y:o*t.distance,image:e.images.questionRight,rect:rect,visible:!0,scaleX:r,scaleY:r}).addTo(t.temporaryQuestionsContainer),t.isText)h[o]=new I.a({id:{realId:o,questionId:n.id},text:n.text,fontSize:70,lineHeight:rect[3]*r,bold:!0,textAlign:"center",reTextWidth:rect[2]*r,height:rect[3]*r-15,visible:!0,alpha:1,x:t.rightX,y:o*t.distance+20,color:"#9d6c3c"}).addTo(t.temporaryQuestionsContainer);else{var c=Math.round(.15*rect[2]),f=Math.round(.15*rect[3]);h[o]=new l.a.Container({id:{realId:o,questionId:n.id},x:t.rightX+c/2,y:o*t.distance+f/2,width:rect[2],height:rect[3],visible:!0,scaleX:1,scaleY:1}).addTo(t.temporaryQuestionsContainer);var img=new Image;img.src=n.text,img.onload=function(e){var t=e.path[0].width,c=e.path[0].height,d=t>c?(rect[2]-40)*r/t:(rect[3]-35)*r/c;new l.a.Bitmap({id:{realId:o,questionId:n.id},x:t>c?0:(rect[2]-80-t*d)/2,y:t>c?(rect[3]-60-c*d)/2:0,width:t*d,height:c*d,image:n.text,visible:!0}).addTo(h[o])}}t.panelClick("right",h[o],d[o],e,t.rightX,o*t.distance,r,t.isText?1.05:.9,rect)})),"touchmove"==l.a.event.POINTER_MOVE&&this.stage.on("mousemove",(function(e){t.readyLine.isStart&&(t.temporaryLinesMove.getNumChildren()>0&&t.temporaryLinesMove.removeChildAt(0),new l.a.Graphics({x:0,y:0,visible:!0}).addTo(t.temporaryLinesMove).beginPath().moveTo(e.stageX,e.stageY).lineStyle(8,"#a7e049").lineTo(t.readyLine.x,t.readyLine.y).endFill().addTo(t.temporaryLinesMove))})),this.stage.on(l.a.event.POINTER_MOVE,(function(e){t.readyLine.isStart&&(t.temporaryLinesMove.getNumChildren()>0&&t.temporaryLinesMove.removeChildAt(0),new l.a.Graphics({x:0,y:0,visible:!0}).addTo(t.temporaryLinesMove).beginPath().moveTo(e.stageX,e.stageY).lineStyle(8,"#a7e049").lineTo(t.readyLine.x,t.readyLine.y).endFill().addTo(t.temporaryLinesMove))}))}},{key:"panelClick",value:function(e,t,n,r,o,c,h,d,rect){var f=this;"touchstart"==l.a.event.POINTER_START&&t.on("mousedown",(function(t){if("panel"===r.type){f.readyLine={isStart:!0,x:t.stageX,y:t.stageY},"right"!==e||f.selected.length||(f.selected[0]=null),f.selected["left"===e?0:1]=t.eventTarget.id,f.temporarySelected.getNumChildren()>0&&f.temporarySelected.removeChildAt(0);var v=new l.a.Graphics({x:o,y:c,visible:!1}).addTo(f.temporarySelected);v.lineStyle(4,"#ff2a2a").drawRoundRect(0,0,rect[2]*h,rect[3]*h,20).endFill(),l.a.Tween.to(n,{scaleX:d,scaleY:d,x:o-.05*rect[2]/2-(f.isText?0:8),y:c-.05*rect[3]/2-(f.isText?0:8)},{duration:100,onComplete:function(){l.a.Tween.to(n,{scaleX:h,scaleY:h,x:o,y:c},{duration:300,onComplete:function(){v.visible=!0}})}}),"panel"===r.type&&f.line(r)}})),t.on(l.a.event.POINTER_START,(function(t){if("panel"===r.type){f.readyLine={isStart:!0,x:t.stageX,y:t.stageY},"right"!==e||f.selected.length||(f.selected[0]=null),f.selected["left"===e?0:1]=t.eventTarget.id,f.temporarySelected.getNumChildren()>0&&f.temporarySelected.removeChildAt(0);var v=new l.a.Graphics({x:o,y:c,visible:!1}).addTo(f.temporarySelected);v.lineStyle(4,"#ff2a2a").drawRoundRect(0,0,rect[2]*h,rect[3]*h,20).endFill(),l.a.Tween.to(n,{scaleX:d,scaleY:d,x:o-.05*rect[2]/2-(f.isText?0:8),y:c-.05*rect[3]/2-(f.isText?0:8)},{duration:100,onComplete:function(){l.a.Tween.to(n,{scaleX:h,scaleY:h,x:o,y:c},{duration:300,onComplete:function(){v.visible=!0}})}}),"panel"===r.type&&f.line(r)}}))}},{key:"verifyRepeat",value:function(){var e=this;return!(2!==this.selected.length||!this.selected.every((function(e){return e})))&&(this.setAnswer.forEach((function(t,n){t[0]!==e.selected[0].realId&&t[1]!==e.selected[1].realId||e.repeatAnswerIndex.push(n)})),!0)}}]),n}(l.a.Container);function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(x.a)(e);if(t){var o=Object(x.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(T.a)(this,n)}}var L=function(e){Object(w.a)(n,e);var t=A(n);function n(e){var r;return Object(y.a)(this,n),(r=t.call(this,e)).model(e),r}return Object(m.a)(n,[{key:"model",value:function(e){new l.a.Container({width:e.width,height:e.height,x:0,y:0,background:"#000",alpha:.5}).addTo(this);var t=e.isAllRight?e.images.rightModel:e.images.errorModel;new l.a.Bitmap({x:.3*e.rect[2]/2,y:0,image:t,rect:e.rect,scaleX:.7,scaleY:.7}).addTo(this)}}]),n}(l.a.Container);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(x.a)(e);if(t){var o=Object(x.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(T.a)(this,n)}}var O=function(e){Object(w.a)(n,e);var t=S(n);function n(e){var r;return Object(y.a)(this,n),(r=t.call(this,e)).resetButton(e),r}return Object(m.a)(n,[{key:"resetButton",value:function(e){var t=this,n=[];e.images.forEach((function(r,o){n[o]=new l.a.Bitmap({x:630*o,y:0,image:r,rect:e.rect,visible:!0,scaleX:1,scaleY:1,id:o}).addTo(t);var c=630*o;"touchstart"==l.a.event.POINTER_START&&n[o].on("mousedown",(function(t){l.a.Tween.to(n[o],{scaleX:1.05,scaleY:1.05,x:c-.05*e.rect[2]/2,y:0-.05*e.rect[3]/2},{duration:100,onComplete:function(){l.a.Tween.to(n[o],{scaleX:1,scaleY:1,x:c,y:0},{duration:300})}})})),n[o].on(l.a.event.POINTER_START,(function(t){l.a.Tween.to(n[o],{scaleX:1.05,scaleY:1.05,x:c-.05*e.rect[2]/2,y:0-.05*e.rect[3]/2},{duration:100,onComplete:function(){l.a.Tween.to(n[o],{scaleX:1,scaleY:1,x:c,y:0},{duration:300})}})}))}))}}]),n}(l.a.Container),P={data:function(){return{timeTranslate:"",gameMain:null,stage:null,assets:null,questions:{},answerQuestionsIds:[],answerRealIds:[],resultIds:[],isAllRight:!1,questionsPanelCanvas:null,questionsResetCanvas:null,questionsSubmitCanvas:null,setAlpha:1}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,f,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$testload();case 3:n=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),n=localStorage.getItem("questionsConfig");case 9:if(n){t.next=11;break}return t.abrupt("return",e.$router.replace("/config"));case 11:return e.questions=JSON.parse(n),e.shuffle(e.questions.right),r=Object(c.a)(e.questions),e.assets=new r,t.next=17,e.assets.load();case 17:e.gameMain=Object(h.a)(),e.stage=e.gameMain.stage,e.$refs.container.appendChild(e.stage.canvas),document.querySelector("canvas"),o=e.assets,l=o.bg,f=o.titleBg,v=new d.a({x:0,y:0,questions:e.questions,images:{bg:l,titleBg:f},title:e.questions.title}),e.stage.addChild(v),e.questionsPanelCanvas=e.createPanel("panel"),e.questionsSubmitCanvas=e.createSubmitButton();case 26:case"end":return t.stop()}}),t,null,[[0,6]])})))()},methods:{createPanel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"panel",t=this.assets,n=t.questionLeft,r=t.questionRight,o=t.errorLine,l=t.rightLine,c=t.questionsImage,h=t.errorIcon,d=t.tipsLine,f=new R({x:0,y:0,images:{questionLeft:n,questionRight:r,errorLine:o,rightLine:l,questionsImage:c,errorIcon:h,tipsLine:d},questions:this.questions,alpha:this.setAlpha,answerQuestionsIds:this.answerQuestionsIds,answerRealIds:this.answerRealIds,resultIds:this.resultIds,type:e,stage:this.stage});return this.stage.addChild(f),f},createSubmitButton:function(){var e=this,t=new f.a({x:795.5,y:962,images:this.assets.submitButton,rect:[0,0,329,96],visible:!0,alpha:this.setAlpha});return"touchstart"==l.a.event.POINTER_START&&t.on("mousedown",(function(n){e.answerQuestionsIds=e.questionsPanelCanvas.setAnswerQuestionsId,e.answerRealIds=e.questionsPanelCanvas.setAnswer,e.answerQuestionsIds.length===e.questions.left.length&&(e.stage.removeChild(e.questionsPanelCanvas),e.questionsPanelCanvas=e.createPanel("result"),e.isAllRight=e.answerQuestionsIds.every((function(e){return e[0]==e[1]})),e.createModel(t))})),t.on(l.a.event.POINTER_START,(function(n){e.answerQuestionsIds=e.questionsPanelCanvas.setAnswerQuestionsId,e.answerRealIds=e.questionsPanelCanvas.setAnswer,e.answerQuestionsIds.length===e.questions.left.length&&(e.stage.removeChild(e.questionsPanelCanvas),e.questionsPanelCanvas=e.createPanel("result"),e.isAllRight=e.answerQuestionsIds.every((function(e){return e[0]==e[1]})),e.createModel(t))})),this.stage.addChild(t),t},createModel:function(e){var t=this,n=new L({x:0,y:0,images:{rightModel:this.assets.rightModel,errorModel:this.assets.errorModel},width:1920,height:1080,rect:[-581,-398.6,1920,1080],isAllRight:this.isAllRight&&this.questions.left.length,visible:!0,alpha:this.setAlpha});return this.stage.addChild(n),setTimeout((function(){t.questionsResetCanvas=t.createRestButtons(),t.questionsSubmitCanvas.visible=!1,t.stage.removeChild(n),t.questionsResetCanvas.visible=!0}),2e3),n},createRestButtons:function(){var e=this,t=this.isAllRight?795.5:481,n=new O({x:t,y:962,images:this.isAllRight?[this.assets.resetBtn]:[this.assets.rightBtn,this.assets.resetBtn],rect:[0,0,329,96],isOnlyReset:this.isAllRight,visible:!1,alpha:this.setAlpha});return"touchstart"==l.a.event.POINTER_START&&n.on("mousedown",(function(t){if(e.stage.removeChild(e.questionsPanelCanvas),e.questionsPanelCanvas=null,e.isAllRight)return e.resetHandel();t.eventTarget.id?e.resetHandel():e.seachHanel()})),n.on(l.a.event.POINTER_START,(function(t){if(e.stage.removeChild(e.questionsPanelCanvas),e.questionsPanelCanvas=null,e.isAllRight)return e.resetHandel();t.eventTarget.id?e.resetHandel():e.seachHanel()})),this.stage.addChild(n),n},resetHandel:function(){this.questionsResetCanvas.visible=!1,this.questionsSubmitCanvas.visible=!0,this.shuffle(this.questions.right),this.answerQuestionsIds=[],this.answerRealIds=[],this.questionsPanelCanvas=this.createPanel("panel")},seachHanel:function(){this.questionsPanelCanvas=this.createPanel("rightResult")},shuffle:function(e){for(var t=this,i=e.length-1;i>=0;i--){var n=Math.floor(Math.random()*(i+1)),r=e[n];e[n]=e[i],e[i]=r}this.questions.right=e,this.questions.left.forEach((function(e,n){t.resultIds[n]=[e.id,t.questions.right.findIndex((function(i){return i.id===e.id}))]}))}}},M=n(41),component=Object(M.a)(P,(function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"container",staticClass:"container"})}),[],!1,null,null,null);t.default=component.exports}}]);